<!doctype html>
<html lang="da">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Valgbar – Vælg valg</title>

  <!-- Tailwind CSS (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root { --vb-navy:#234a5a; --vb-navy-2:#1f4352; }
    .vb-hero{
      background: linear-gradient(180deg, var(--vb-navy) 0%, var(--vb-navy-2) 100%);
      color:#fff;
    }
    .vb-row{
      background: linear-gradient(180deg, #ffffff 0%, #f8fafc 100%);
      border:1px solid #e5e7eb; border-radius:12px; box-shadow:0 1px 2px rgba(16,24,40,.04);
    }
    .vb-row:hover{ box-shadow:0 4px 14px rgba(0,0,0,.06); }
    .vb-chevron{ transition: transform .2s ease; }
    .vb-open .vb-chevron{ transform: rotate(180deg); }
    .vb-body{
      overflow:hidden;
      transition:grid-template-rows .25s ease, padding .2s ease;
      display:grid;
      grid-template-rows:0fr;
    }
    .vb-open .vb-body{ grid-template-rows:1fr; }
    .vb-body > div{ min-height:0; }
    .vb-yearbtn{
      display:flex; align-items:center; justify-content:center;
      padding:.8rem 1rem; border:1px solid #e5e7eb; border-radius:10px; background:#fff; font-weight:600;
    }
    .vb-yearbtn:hover{ background:#f3f4f6; }
    .vb-yearbtn[aria-disabled="true"]{ opacity:.6; cursor:not-allowed; }

    .vb-live-pill{
      display:inline-flex;
      align-items:center;
      gap:.35rem;
      padding:.15rem .55rem;
      border-radius:9999px;
      background:rgba(16,185,129,.1);
      color:#047857;
      font-size:.75rem;
      font-weight:600;
      text-transform:uppercase;
      letter-spacing:.05em;
    }
  </style>
</head>

<body class="bg-gray-50 text-gray-900">
  <!-- HEADER -->
  <header class="vb-hero">
    <div class="mx-auto max-w-6xl px-4 pt-8 pb-3">
      <a href="./" aria-label="Valgbar" class="inline-block">
        <img src="Valgbar-transparent3.png" alt="Valgbar" class="h-28 md:h-32 w-auto" />
      </a>
    </div>

    <div class="border-t border-white/20"></div>
  </header>

  <!-- INDHOLD -->
  <main class="mx-auto max-w-5xl p-4 md:p-6 space-y-4">

    <!-- LIVE-BOKS -->
    <section id="liveBox"
             class="vb-row border-l-4 border-emerald-500/80 bg-emerald-50/60 px-4 md:px-5 py-4 hidden">
      <div class="flex flex-col gap-3 md:flex-row md:items-center md:justify-between">
        <div>
          <div class="vb-live-pill">
            <span class="inline-block w-2 h-2 rounded-full bg-emerald-500 animate-pulse"></span>
            Live
          </div>
          <h2 class="mt-2 text-base md:text-lg font-semibold text-emerald-900">
            Live-resultater
          </h2>
          <p class="text-sm text-emerald-900/80" id="liveDescription">
            Følg med i de valg, hvor der løbende tikker nye stemmetal ind.
          </p>

          <div class="mt-3 space-y-1 text-xs md:text-sm text-emerald-900/80">
            <p>Der opdateres løbende stemmer for kommunal- og regionsrådsvalg</p>.
          </div>
        </div>
        <div id="liveLinks" class="flex flex-col sm:flex-row gap-2 md:gap-3 mt-3 md:mt-0"></div>
      </div>
    </section>

    <!-- LISTE MED VALG -->
    <section id="list" class="space-y-3">
      <!-- Rækker indsprøjtes af JS -->
    </section>
  </main>

  <footer class="mt-10 border-t bg-gray-100">
    <div class="mx-auto max-w-6xl px-4 py-6 md:py-8
                flex flex-col md:flex-row items-center justify-between
                gap-3 md:gap-6 text-sm md:text-base text-gray-700">
      
      <a href="mailto:hej@valgbar.dk" class="font-medium hover:text-gray-900">
        hej@valgbar.dk
      </a>

      <p class="text-center">
        Data stammer fra KMDValg, Danmarks Statistik og valg.dk
      </p>

      <a href="/om-valgbar/" class="font-medium underline hover:text-gray-900">
        Om Valgbar
      </a>
    </div>
  </footer>

  <script>
    /* ====== KONFIG ====== */

    // Live-konfiguration
    const LIVE = [
      {
        type: 'kv',
        year: 2025,
        title: 'Kommunalvalg 2025',
        href: 'kv/2025/'
      },
      {
        type: 'rv',
        year: 2025,
        title: 'Regionsrådsvalg 2025',
        href: 'rv/2025/'
      }
    ];

    const YEARS = {
      // FT: 2007, 2011, 2015, 2019, 2022 (2005 fjernet)
      ft: [2022, 2019, 2015, 2011, 2007],
      // KV: 2025, 2021, 2017, 2013, 2009, 2005
      kv: [2025, 2021, 2017, 2013, 2009, 2005],
      // RV: 2025, 2021, 2017
      rv: [2025, 2021, 2017],
      // EP: 2009, 2014, 2019, 2024
      ep: [2024, 2019, 2014, 2009],
      // FA: Folkeafstemning
      fa: [2022, 2015, 2014]
    };

    // Ingen år er pt. deaktiveret
    const DISABLED = {
      // tom
    };

    // Brug relative stier så de virker i undermapper
    const DEST = {
      kv: { perYear: {
        2025: 'kv/2025/',
        2021: 'kv/2021/',
        2017: 'kv/2017/',
        2013: 'kv/2013/',
        2009: 'kv/2009/',
        2005: 'kv/2005/',
        2001: 'kv/2001/'
      }},
      ft: { perYear: {
        2022: 'ft/2022/',
        2019: 'ft/2019/',
        2015: 'ft/2015/',
        2011: 'ft/2011/',
        2007: 'ft/2007/',
        2005: 'ft/2005/'
      }},
      rv: { perYear: {
        2025: 'rv/2025/',
        2021: 'rv/2021/',
        2017: 'rv/2017/',
        2013: 'rv/2013/'
      }},
      ep: { perYear: {
        2024: 'ep/2024/',
        2019: 'ep/2019/',
        2014: 'ep/2014/',
        2009: 'ep/2009/',
        2004: 'ep/2004/'
      }},
      fa: { perYear: {
        2022: 'fa/2022/',
        2015: 'fa/2015/',
        2014: 'fa/2014/'
      }}
    };

    const TITLES = {
      ft:'Folketingsvalg',
      kv:'Kommunalvalg',
      rv:'Regionsrådsvalg',
      ep:'Europa-Parlamentsvalg',
      fa:'Folkeafstemning'
    };

    const ORDER = ['ft','kv','rv','ep','fa'];

    /* ====== RENDER ====== */
    const root = document.getElementById('list');

    // Byg accordion-rækkerne
    ORDER.forEach(type=>{
      const years = YEARS[type] || [];
      const article = document.createElement('article');
      article.className = 'vb-row';

      article.innerHTML = `
        <button type="button"
                class="w-full flex items-center gap-3 px-4 md:px-5 py-4 text-left"
                aria-expanded="false"
                data-acc="${type}">
          <h2 class="text-base md:text-lg font-semibold text-slate-800 flex-1">${TITLES[type]}</h2>
          <svg class="vb-chevron h-5 w-5 text-slate-500" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path d="M5.23 7.21a.75.75 0 011.06.02L10 11.1l3.71-3.87a.75.75 0 111.08 1.04l-4.24 4.43a.75.75 0 01-1.08 0L5.27 8.27a.75.75 0 01-.04-1.06z"/>
          </svg>
        </button>

        <div class="vb-body">
          <div>
            <div class="px-4 md:px-5 pt-0 pb-4">
              <div class="grid grid-cols-2 sm:grid-cols-3 gap-2">
                ${years.map(y=>{
                  const isDisabled = DISABLED[type]?.includes(y);
                  const hasUrl = !!DEST[type]?.perYear?.[y];
                  const active = hasUrl && !isDisabled;
                  const url = active ? DEST[type].perYear[y] : '#';
                  return `<a class="vb-yearbtn"
                               href="${url}"
                               data-type="${type}" data-year="${y}"
                               aria-disabled="${active ? 'false':'true'}">${y}</a>`;
                }).join('')}
              </div>
            </div>
          </div>
        </div>
      `;
      root.appendChild(article);
    });

    // Byg LIVE-boks ud fra LIVE-konfiguration
    (function renderLiveBox(){
      const liveRoot = document.getElementById('liveBox');
      const liveLinks = document.getElementById('liveLinks');
      if (!liveRoot || !liveLinks) return;

      const activeLive = (LIVE || []).filter(item => !!item && !!item.href);
      if (!activeLive.length) return;

      liveRoot.classList.remove('hidden');

      if (activeLive.length === 1) {
        const d = document.getElementById('liveDescription');
        if (d) {
          d.textContent = `Følg med i ${activeLive[0].title} – tal opdateres løbende.`;
        }
      }

      activeLive.forEach(item => {
        const a = document.createElement('a');
        a.href = item.href;
        a.className = 'inline-flex items-center justify-center rounded-full border border-emerald-600 bg-emerald-600 px-4 py-2 text-sm font-semibold text-white shadow-sm hover:bg-emerald-700 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-emerald-600';
        a.innerHTML = `
          <span>${item.title}</span>
          <svg class="ml-2 h-4 w-4" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true">
            <path d="M7 5l6 5-6 5V5z" />
          </svg>
        `;
        liveLinks.appendChild(a);
      });
    })();

    /* ====== INTERAKTION ====== */
    root.addEventListener('click', (e)=>{
      const btn = e.target.closest('[data-acc]');
      if(btn){
        const article = btn.closest('article');
        const open = article.classList.toggle('vb-open');
        btn.setAttribute('aria-expanded', open ? 'true' : 'false');
        if(open){
          document.querySelectorAll('#list article.vb-open').forEach(el=>{
            if(el!==article){
              el.classList.remove('vb-open');
              el.querySelector('[data-acc]').setAttribute('aria-expanded','false');
            }
          });
        }
      }
    });

    root.addEventListener('keydown', (e)=>{
      const btn = e.target.closest('[data-acc]');
      if(btn && (e.key==='Enter' || e.key===' ')){
        e.preventDefault(); btn.click();
      }
    });

    root.addEventListener('click', (e)=>{
      const link = e.target.closest('.vb-yearbtn');
      if(!link) return;
      const active = link.getAttribute('aria-disabled') === 'false';
      if(!active){
        e.preventDefault();
        const type = link.getAttribute('data-type');
        const year = link.getAttribute('data-year');
        alert(`${TITLES[type]} ${year} er ikke aktiveret endnu.`);
      }
    });
  </script>
</body>
</html>
